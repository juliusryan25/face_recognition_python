<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Rekap Kehadiran Karyawan</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous">
</head>
<body>
    <div class="container-fluid p-3">
        <div class="row">
        
            <div class="col-12">
                <h3>Absen</h3>
                <table class="table table-striped shadow rounded pt-1" id="data-table-absen">
                    <!-- Tabel akan diisi dengan data dari server -->
                </table>
            </div>
        </div>

    </div>
    <!-- <script>
        function fetchDataMasuk() {
            $.ajax({
                url: '/get_data_masuk',
                type: 'GET',
                success: function(data) {
                    var table = $('#data-table-masuk');
                    table.empty(); // Bersihkan tabel lama
                    // header tabel
                    table.append('<thead class="thead-dark"><tr><th>No</th><th>NIK</th><th>Nama Karyawan</th><th>Tanggal</th><th>Jam Masuk</th></tr></thead>');
                    // Iterasi dan tambahkan data ke tabel
                    data.forEach(function(row, index) {
                        // Format tanggal dan jam dari row[1]
                        var date = new Date(row[2]);
                        var formattedDate = date.toLocaleDateString('id-ID', {
                                            weekday: "long",
                                            month: "long",
                                            day: "numeric",
                                            year: "numeric"
                                            });
                        var formattedTime = date.toLocaleTimeString('id-ID', {
                                            hour: "2-digit",
                                            minute: "2-digit"
                                            });
                        // Tambahkan baris dengan nomor urut dan data yang sudah diformat
                        table.append('<tbody class="table-light"><tr><td>' + (index + 1) + '</td><td>' + row[3] + '</td><td>' + row[1] + '</td><td>' + formattedDate + '</td><td>' + formattedTime + '</td></tr></tbody>');
                    });
                }
            });
        }
        // Panggil fetchData setiap 5 detik untuk pembaruan data
        setInterval(fetchDataMasuk, 2000);
        
    </script>
    <script>
        function fetchDataPulang() {
            $.ajax({
                url: '/get_data_pulang',
                type: 'GET',
                success: function(data) {
                    var table = $('#data-table-pulang');
                    table.empty(); // Bersihkan tabel lama
                    // header tabel
                    table.append('<thead class="thead-light"><tr><th>No</th><th>NIK</th><th>Nama Karyawan</th><th>Tanggal</th><th>Jam Pulang</th></tr></thead>');
                    // Iterasi dan tambahkan data ke tabel
                    data.forEach(function(row, index) {
                        // Format tanggal dan jam dari row[1]
                        var date = new Date(row[2]);
                        var formattedDate = date.toLocaleDateString('id-ID', {
                                            weekday: "long",
                                            month: "long",
                                            day: "numeric",
                                            year: "numeric"
                                            });
                        var formattedTime = date.toLocaleTimeString('id-ID', {
                                            hour: "2-digit",
                                            minute: "2-digit"
                                            });
                        // Tambahkan baris dengan nomor urut dan data yang sudah diformat
                        table.append('<tbody class="table-dark"><tr><td>' + (index + 1) + '</td><td>' + row[3] + '</td><td>' + row[1] + '</td><td>' + formattedDate + '</td><td>' + formattedTime + '</td></tr></tbody>');
                    });
                }
            });
        }
        setInterval(fetchDataPulang, 2000);
    </script> -->
    <script>
        function fetchDataAbsen() {
            $.ajax({
                url: '/get_data_absen',
                type: 'GET',
                success: function(data) {
                    var table = $('#data-table-absen');
                    table.empty(); // Bersihkan tabel lama
                    // header tabel
                    table.append('<thead class="thead-dark"><tr><th>No</th><th>NIK</th><th>Nama Karyawan</th><th>Departemen</th><th>Tanggal</th><th>Jam Kerja</th><th>Jam Masuk</th><th>Jam Pulang</th><th>Keterangan</th></tr></thead>');
                    // Iterasi dan tambahkan data ke tabel
                    data.forEach(function(row, index) {
                        // Format tanggal dan jam dari row[1]
                        var dateMasuk = new Date(row[2]);
                        var datePulang = new Date(row[3]);
                        if (row[3] == null) {
                            var formattedTimePulang = "-"
                        }
                        else{
                            var formattedTimePulang = datePulang.toLocaleTimeString('id-ID', {
                                                hour: "2-digit",
                                                minute: "2-digit"
                                                });
                            
                        }
                        var formattedDate = dateMasuk.toLocaleDateString('id-ID', {
                                            weekday: "long",
                                            month: "long",
                                            day: "numeric",
                                            year: "numeric"
                                            });
                        var formattedTimeMasuk = dateMasuk.toLocaleTimeString('id-ID', {
                                            hour: "2-digit",
                                            minute: "2-digit"
                                            });
                        // Tambahkan baris dengan nomor urut dan data yang sudah diformat
                        table.append('<tbody class="table-light"><tr><td>' + (index + 1) + '</td><td>' + row[0] + '</td><td>' + row[1] + '</td><td>' + row[4] + '</td><td>' + formattedDate + '</td><td>' + row[5] + '</td><td>' + formattedTimeMasuk + '</td><td>' + formattedTimePulang + '</td><td>' + row[6] + '</td></tr></tbody>');
                    });
                }
            });
        }
        // Panggil fetchData setiap 5 detik untuk pembaruan data
        setInterval(fetchDataAbsen, 2000);
       
    </script>
</body>
</html>
