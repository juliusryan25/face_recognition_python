<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Rekap Kehadiran Karyawan</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>
<body>
    <table id="data-table" border="1">
        <!-- Tabel akan diisi dengan data dari server -->
    </table>
    <!-- <table border="1">
        <tr>
            <th>No</th>
            <th>Nama Karyawan</th>
            <th>Tanggal</th>
            <th>Jam Masuk</th>
        </tr>
        {% for data in attendance_data %}
        <tr>
            <td>{{ loop.index }}</td>
            <td>{{ data[0] }}</td>
            <td>{{ data[1].strftime('%D') }}</td>
            <td>{{ data[1].strftime('%H:%M') }}</td>
        </tr>
        {% endfor %}
    </table> -->
    <script>
        function fetchData() {
            $.ajax({
                url: '/get_data',
                type: 'GET',
                success: function(data) {
                    var table = $('#data-table');
                    table.empty(); // Bersihkan tabel lama
                    // header tabel
                    table.append('<tr><th>No</th><th>Nama Karyawan</th><th>Tanggal</th><th>Jam Masuk</th></tr>');
                    // Iterasi dan tambahkan data ke tabel
                    data.forEach(function(row, index) {
                        // Format tanggal dan jam dari row[1]
                        var date = new Date(row[1]);
                        var formattedDate = date.toLocaleDateString('id-ID', {
                                            weekday: "long",
                                            month: "long",
                                            day: "numeric",
                                            year: "numeric"
                                            });
                        var formattedTime = date.toLocaleTimeString('id-ID', {
                                            hour: "2-digit",
                                            minute: "2-digit"
                                            });
                        // Tambahkan baris dengan nomor urut dan data yang sudah diformat
                        table.append('<tr><td>' + (index + 1) + '</td><td>' + row[0] + '</td><td>' + formattedDate + '</td><td>' + formattedTime + '</td></tr>');
                    });
                }
            });
        }
    
        // Panggil fetchData setiap 5 detik untuk pembaruan data
        setInterval(fetchData, 2000);
    </script>
</body>
</html>
